# -*- coding: utf-8 -*-"
#+STARTUP: overview indent
#+OPTIONS: html-link-use-abs-url:nil html-postamble:auto
#+OPTIONS: html-preamble:t html-scripts:t html-style:t
#+OPTIONS: html5-fancy:nil tex:t
#+HTML_DOCTYPE: xhtml-strict
#+HTML_CONTAINER: div
#+DESCRIPTION:
#+KEYWORDS:
#+HTML_LINK_HOME:
#+HTML_LINK_UP:
#+HTML_MATHJAX:
#+HTML_HEAD:
#+HTML_HEAD_EXTRA:
#+SUBTITLE:
#+INFOJS_OPT:
#+CREATOR: <a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.2.2 (<a href="http://orgmode.org">Org</a> mode 9.0.1)
#+LATEX_HEADER:
#+EXPORT_EXCLUDE_TAGS: noexport
#+EXPORT_SELECT_TAGS: export
#+TAGS: noexport(n) deprecated(d)

* Planejamento                                                     :noexport:
** Modelo do cronograma em TEX                                      :ATTACH:
:PROPERTIES:
:Attachments: layout-cronograma.tex
:ID:       be43e1ff-0a91-4c3f-9e17-1fa62e6795ce
:END:

** Aulas (em ORG)

#+NAME: listagem_de_encontros
| Setor      | Descrição                                                 | Local         | Projeto              |
|------------+-----------------------------------------------------------+---------------+----------------------|
| Abertura   | Definições, requisitos e posicionamento  (Presencial, G1) | Teórica       | Definições iniciais  |
| Abertura   | Definições, requisitos e posicionamento  (Presencial, G2) | Teórica       | Definições iniciais  |
| Léxica     | Introdução, Expressões Regulares, =flex=                    |               | Início E1 (flex)     |
| Léxica     | Autômato Finito Determinístico, Conv. AFND para AFD       |               |                      |
| Sintática  | Intro., Gramáticas Livres de Contexto, Transformações     |               |                      |
| Sintática  | Desc., com Retrocesso, Preditivo (Primeiro, Sequência)    |               |                      |
| Sintática  | Parser e tabela LL(1), Exercício LL(1), =bison=             |               | Início E2 (bison)    |
| Sintática  | Ascendente, Parser LR(0)                                  |               |                      |
| Projeto    | Acompanhamento  (Presencial, G1)                          | Laboratório   |                      |
| Projeto    | Acompanhamento  (Presencial, G2)                          | Laboratório   |                      |
| Sintática  | Exercícios LR(0), SLR(1)                                  |               | Início E3 (Árvore)   |
| Sintática  | Parser LR(1)                                              |               |                      |
| Sintática  | Parser LALR(1), AST e =bison= (ações)                       |               |                      |
| Sintática  | Exercícios LR(1), e LALR(1)                               |               |                      |
| Projeto    | Acompanhamento  (Presencial, G1)                          | Laboratório   | Início E4 (Tipos)    |
| Projeto    | Acompanhamento  (Presencial, G2)                          | Laboratório   |                      |
| Semântica  | Esquemas S e L-Atribuídos                                 |               |                      |
| Semântica  | Implementação de Esquemas S e L-Atribuídos                |               |                      |
|            | Revisão                                                   |               | Início E5 (Código)   |
|            | P1 (presencial, G1 e G2)                                  | 2xLaboratório |                      |
| Código     | Declarações, Escopos e Atribuição                         |               |                      |
| Código     | Expressões Lógicas com atalho, Controle de Fluxo          |               |                      |
| Projeto    | Acompanhamento (Presencial, G1)                           | Laboratório   | Início E6 (Assembly) |
| Projeto    | Acompanhamento (Presencial, G2)                           | Laboratório   |                      |
| Código     | Endereçamento de Arranjos multidimensionais               |               |                      |
| Código     | Controle de Fluxo                                         |               |                      |
| Execução   | Introdução, Registro de Ativação                          |               | Início E7 (Otim.)    |
| Execução   | Chamada e retorno de Função, Passagem de parâmetros       |               |                      |
| Otimização | Introdução, Janela e Grafos de Fluxo                      |               |                      |
| Otimização | Grafos de Fluxo e Redução de potência                     |               |                      |
|            | Revisão                                                   |               |                      |
|            | P2 (Presencial, G1 e G2)                                  | 2xLaboratório |                      |
|            | PR                                                        |               |                      |

** Cronograma (para TEX)

#+name: cronograma
#+header: :var aulas=listagem_de_encontros
#+begin_src R :results output :session :exports both
options(crayon.enabled=FALSE)
suppressMessages(library(lubridate));
suppressMessages(library(tidyverse));
suppressMessages(library(xtable));

aulas <- aulas %>% as_tibble();

daysOff <- c(
ymd("2022-02-28"), # Carnaval
ymd("2022-03-01"), # Carnaval
ymd("2022-03-02"), # Carnaval
ymd("2022-03-03"), # Carnaval
ymd("2022-03-04")#, # Carnaval
#ymd("2022-04-15"), # Religioso
#ymd("2022-04-21"), # Tiradentes
#ymd("2022-05-01"), # Trabalho
#ymd("2022-06-16"), # Religioso
#ymd("2022-09-07"), # Independência
#ymd("2022-09-20"), # Farroupilha
#ymd("2022-10-12"), # Religioso
#ymd("2022-11-02"), # Mortos
#ymd("2022-11-15")  # República
)

dataDaRecuperação <- ymd("2022-05-16");

dates <- tibble(Dia=seq(ymd("2022-01-17"), ymd("2022-05-18"), by="days")) %>%
    # Define o dia da semana
    mutate(DiaDaSemana = wday(Dia)) %>%
    # Aulas de Compiladores em quais dias da semana (segunda = 2, terca = 3, ...)
    filter(DiaDaSemana %in% c(2, 4)) %>%
    # Remove dias onde não haverá aula
    filter(!(Dia %in% daysOff));

aulas %>%
    # Associa as datas
    bind_cols(dates %>% slice(1:nrow(aulas))) %>%
    # Altera a data da PR
    mutate(Dia = case_when (grepl("PR", Descrição) ~ dataDaRecuperação,
                            TRUE ~ Dia)) %>%
    # Converte as datas para caracter
    mutate(Encontro = as.character(Dia)) %>%
    # Ordena as aulas
    mutate(N = 1:nrow(.)) -> aulas;

aulas %>%
    mutate(S = as.integer(floor((N+1)/2))) %>%
    select(S, N, Encontro, Local, Setor, Descrição, Projeto) %>%
    as.data.frame() %>%
    xtable(.) %>%
    print (floating = FALSE,
           print.results=FALSE,
           booktabs = TRUE,
           include.rownames=FALSE) %>%
    as.character -> cronograma;
#+end_src

#+RESULTS: cronograma

** Dias por etapa do projeto (em R)

#+name: dias_por_etapa
#+header: :var dep=cronograma
#+begin_src R :results output :session *R* :exports both
aulas %>%
    select(Projeto, Dia) %>%
    filter(grepl("Início", Projeto)) %>%
    mutate(Projeto = gsub("Início ", "", Projeto)) %>%
    mutate(Projeto = gsub(" \\(.*$", "", Projeto)) %>%
    rename(Início = Dia) %>%
    mutate(Fim = lead(Início, default=(max(.$Início)+17)) +2) %>%
    mutate(Duração = as.integer(Fim - Início)) %>%
    as.data.frame() %>%
    mutate(Início = as.character(Início)) %>%
    mutate(Fim = as.character(Fim)) %>%
    print %>%
    xtable(.) %>%
    print (print.results=FALSE,
           booktabs = TRUE,
           include.rownames=FALSE) %>%
    as.character -> dias_por_etapa
#+end_src

#+RESULTS: dias_por_etapa
: 
:   Projeto     Início        Fim Duração
: 1      E1 2022-01-24 2022-02-09      16
: 2      E2 2022-02-07 2022-02-23      16
: 3      E3 2022-02-21 2022-03-16      23
: 4      E4 2022-03-14 2022-03-30      16
: 5      E5 2022-03-28 2022-04-13      16
: 6      E6 2022-04-11 2022-04-27      16
: 7      E7 2022-04-25 2022-05-14      19

#+RESULTS:

** Cronograma (em PDF)

#+name: modelo_cronograma
#+header: :var dep0=cronograma
#+header: :var dep1=dias_por_etapa
#+begin_src R :results output :session :exports both
cronograma.modelo.filename = "data/be/43e1ff-0a91-4c3f-9e17-1fa62e6795ce/layout-cronograma.tex"
cronograma.modelo = readChar(cronograma.modelo.filename, file.info(cronograma.modelo.filename)$size);
turma = "A";
semestre = "2021/2 -- Verão/Outono";
cronograma.modelo <- gsub("TURMA", turma, cronograma.modelo);
cronograma.modelo <- gsub("SEMESTRE", semestre, cronograma.modelo);
cronograma.modelo <- gsub("TABELA", gsub("\\\\", "\\\\\\\\", cronograma), cronograma.modelo);
cronograma.modelo <- gsub("DIASPORETAPA", gsub("\\\\", "\\\\\\\\", dias_por_etapa), cronograma.modelo);
write(cronograma.modelo, "cronograma.tex");
system2("rm", "-f cronograma.pdf")
system2("rubber", " --pdf cronograma.tex")
#+end_src

#+RESULTS: modelo_cronograma
: 
: compiling cronograma.tex
: executing: pdflatex \nonstopmode \input{cronograma.tex}

* Cronograma

O cronograma também está [[./cronograma.pdf][disponível em formato PDF]].

#+header: :var dep=cronograma
#+begin_src R :results value table :session :exports output :colnames yes
aulas %>%
    select(N, Encontro, Local, Setor, Descrição, Projeto) %>%
    as.data.frame
#+end_src

#+RESULTS:
|  N |   Encontro |     Local | Setor      | Descrição                                                        | Projeto             |
|----+------------+-----------+------------+------------------------------------------------------------------+---------------------|
|  1 | 2019-08-12 |           |            | Definições, requisitos e posicionamento da disciplina            | Definições iniciais |
|  2 | 2019-08-14 |           | Léxica     | Introdução, Expressões Regulares, =flex=                           | Início E1 (flex)    |
|  3 | 2019-08-19 |           | Léxica     | Autômato Finito Determinístico, Conv. AFND para AFD, =flex= (demo) |                     |
|  4 | 2019-08-21 |           | Sintática  | Intro., Gramáticas Livres de Contexto, Transformações            |                     |
|  5 | 2019-08-26 |           | Sintática  | Desc., com Retrocesso, Preditivo (Primeiro, Sequência)           |                     |
|  6 | 2019-08-28 |           | Sintática  | Parser e tabela LL(1), Exercício LL(1), =bison=                    | Início E2 (bison)   |
|  7 | 2019-09-02 |           | Sintática  | Ascendente, Parser LR(0), SLR(1) , =bison= (demo)                  |                     |
|  8 | 2019-09-04 |           | Sintática  | Exercícios LR(0), SLR(1)                                         |                     |
|  9 | 2019-09-09 |           | Sintática  | Parser LR(1), LALR(1)                                            |                     |
| 10 | 2019-09-11 |           | Sintática  | Exercícios LR(1), e LALR(1), AST e =bison= (ações)                 |                     |
| 11 | 2019-09-16 | 43413-104 |            |                                                                  | Avaliação E1, E2    |
| 12 | 2019-09-18 |           | Semântica  | Esquemas S e L-Atribuídos                                        | Início E3 (Árvore)  |
| 13 | 2019-09-23 |           | Semântica  | Implementação de Esquemas S e L-Atribuídos                       |                     |
| 14 | 2019-09-25 |           |            | Revisão                                                          | Início E4 (Tipos)   |
| 15 | 2019-09-30 |           |            | P1                                                               |                     |
| 16 | 2019-10-02 |           | Código     | Declarações, Escopos e Atribuição                                |                     |
| 17 | 2019-10-07 | 43413-104 |            |                                                                  | Avaliação E3        |
| 18 | 2019-10-09 |           | Código     | Expressões Lógicas com atalho, Controle de Fluxo                 |                     |
| 19 | 2019-10-14 |           | Código     | Endereçamento de Arranjos multidimensionais                      |                     |
| 20 | 2019-10-16 |           | Código     | Controle de Fluxo                                                | Início E5 (Código)  |
| 21 | 2019-10-30 | 43413-103 |            |                                                                  | Avaliação E4        |
| 22 | 2019-11-04 |           | Código     | Controle de Fluxo                                                |                     |
| 23 | 2019-11-06 |           | Execução   | Introdução, Registro de Ativação                                 |                     |
| 24 | 2019-11-11 |           | Execução   | Chamada e retorno de Função, Passagem de parâmetros              | Início E6 (Chamada) |
| 25 | 2019-11-13 |           | Otimização | Introdução, Janela e Grafos de Fluxo                             |                     |
| 26 | 2019-11-18 | 43413-103 |            |                                                                  | Avaliação E5        |
| 27 | 2019-11-20 |           | Otimização | Grafos de Fluxo e Redução de potência                            |                     |
| 28 | 2019-11-25 |           |            | Revisão                                                          |                     |
| 29 | 2019-11-27 |           |            | P2                                                               |                     |
| 30 | 2019-12-09 |           |            | PR                                                               |                     |


